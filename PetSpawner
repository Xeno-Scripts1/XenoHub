--// Xeno's Visual Pet Spawner (Full Safe Edition with TextBoxes)

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local Backpack = LocalPlayer:WaitForChild("Backpack")

-- Clean old UI
if PlayerGui:FindFirstChild("XenoPetSpawnerUI") then
    PlayerGui.XenoPetSpawnerUI:Destroy()
end

-- ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "XenoPetSpawnerUI"
screenGui.ResetOnSpawn = false
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
screenGui.Parent = PlayerGui

-- Toggle hotkey (X)
screenGui.Enabled = true
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if not gameProcessed and input.KeyCode == Enum.KeyCode.X then
        screenGui.Enabled = not screenGui.Enabled
    end
end)

-- Main Frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0,450,0,360)
mainFrame.Position = UDim2.new(0.5,-225,0.5,-180)
mainFrame.BackgroundColor3 = Color3.fromRGB(0,0,0)
mainFrame.BackgroundTransparency = 0.2
mainFrame.BorderSizePixel = 0
mainFrame.ClipsDescendants = true
mainFrame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0,12)
corner.Parent = mainFrame

-- Draggable
local dragging, dragInput, dragStart, startPos
local function update(input)
    local delta = input.Position - dragStart
    mainFrame.Position = UDim2.new(
        startPos.X.Scale, startPos.X.Offset + delta.X,
        startPos.Y.Scale, startPos.Y.Offset + delta.Y
    )
end

mainFrame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = mainFrame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)
mainFrame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement then
        dragInput = input
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if input == dragInput and dragging then update(input) end
end)

-- Title Bar
local titleBar = Instance.new("Frame")
titleBar.Size = UDim2.new(1,0,0,35)
titleBar.BackgroundColor3 = Color3.fromRGB(30,30,30)
titleBar.BackgroundTransparency = 0.3
titleBar.BorderSizePixel = 0
titleBar.Parent = mainFrame

local titleBarCorner = Instance.new("UICorner")
titleBarCorner.CornerRadius = UDim.new(0,12)
titleBarCorner.Parent = titleBar

local titleLabel = Instance.new("TextLabel")
titleLabel.Text = "ðŸ¾  Xeno's Pet Spawner  âš ï¸"
titleLabel.Font = Enum.Font.SourceSansBold
titleLabel.TextSize = 20
titleLabel.TextColor3 = Color3.new(1,1,1)
titleLabel.BackgroundTransparency = 1
titleLabel.Size = UDim2.new(1,0,1,0)
titleLabel.TextXAlignment = Enum.TextXAlignment.Center
titleLabel.Parent = titleBar

-- Close button
local closeButton = Instance.new("TextButton")
closeButton.Text = "âŒ"
closeButton.Font = Enum.Font.SourceSansBold
closeButton.TextSize = 18
closeButton.TextColor3 = Color3.new(1,1,1)
closeButton.BackgroundColor3 = Color3.fromRGB(50,50,50)
closeButton.Size = UDim2.new(0,30,0,30)
closeButton.Position = UDim2.new(1,-35,0,3)
closeButton.Parent = titleBar

local closeCorner = Instance.new("UICorner")
closeCorner.CornerRadius = UDim.new(1,0)
closeCorner.Parent = closeButton

closeButton.MouseEnter:Connect(function()
    closeButton.BackgroundColor3 = Color3.fromRGB(200,50,50)
end)
closeButton.MouseLeave:Connect(function()
    closeButton.BackgroundColor3 = Color3.fromRGB(50,50,50)
end)
closeButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Warning Label
local warningLabel = Instance.new("TextLabel")
warningLabel.Text = "âš ï¸ WARNING: Do NOT leave the game during spawning, or you may get banned!"
warningLabel.Font = Enum.Font.SourceSansBold
warningLabel.TextSize = 16
warningLabel.TextColor3 = Color3.fromRGB(255,255,0)
warningLabel.BackgroundTransparency = 1
warningLabel.Size = UDim2.new(1,-20,0,40)
warningLabel.Position = UDim2.new(0,10,0,50)
warningLabel.TextWrapped = true
warningLabel.TextXAlignment = Enum.TextXAlignment.Center
warningLabel.Parent = mainFrame

-- TextBoxes with labels
local function createLabeledBox(labelText, posY)
    local label = Instance.new("TextLabel")
    label.Text = labelText
    label.Font = Enum.Font.SourceSansBold
    label.TextSize = 16
    label.TextColor3 = Color3.fromRGB(255,255,255)
    label.BackgroundTransparency = 1
    label.Position = UDim2.new(0,25,posY,0)
    label.Size = UDim2.new(0,150,0,20)
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = mainFrame

    local box = Instance.new("TextBox")
    box.Size = UDim2.new(0,200,0,30)
    box.Position = UDim2.new(0,25,posY+25,0)
    box.BackgroundColor3 = Color3.fromRGB(60,60,60)
    box.TextColor3 = Color3.fromRGB(255,255,255)
    box.Font = Enum.Font.SourceSans
    box.TextSize = 16
    box.PlaceholderText = "Enter "..labelText
    box.Parent = mainFrame
    return box
end

local petBox = createLabeledBox("Pet Name", 100)
local weightBox = createLabeledBox("Weight", 160)
local ageBox = createLabeledBox("Age", 220)

-- Loading bar
local loadingBarContainer = Instance.new("Frame")
loadingBarContainer.Size = UDim2.new(0.8,0,0,25)
loadingBarContainer.Position = UDim2.new(0.1,0,0,270)
loadingBarContainer.BackgroundColor3 = Color3.fromRGB(50,50,50)
loadingBarContainer.BackgroundTransparency = 0.4
loadingBarContainer.BorderSizePixel = 0
loadingBarContainer.Visible = false
loadingBarContainer.Parent = mainFrame

local loadingCorner = Instance.new("UICorner")
loadingCorner.CornerRadius = UDim.new(0,8)
loadingCorner.Parent = loadingBarContainer

local loadingBar = Instance.new("Frame")
loadingBar.Size = UDim2.new(0,0,1,0)
loadingBar.Position = UDim2.new(0,0,0,0)
loadingBar.BackgroundColor3 = Color3.fromRGB(140,0,255)
loadingBar.BorderSizePixel = 0
loadingBar.Parent = loadingBarContainer

local loadingBarCorner = Instance.new("UICorner")
loadingBarCorner.CornerRadius = UDim.new(0,8)
loadingBarCorner.Parent = loadingBar

local loadingPercentInside = Instance.new("TextLabel")
loadingPercentInside.Text = "0%"
loadingPercentInside.Font = Enum.Font.SourceSansBold
loadingPercentInside.TextSize = 16
loadingPercentInside.TextColor3 = Color3.new(1,1,1)
loadingPercentInside.BackgroundTransparency = 1
loadingPercentInside.Size = UDim2.new(1,0,1,0)
loadingPercentInside.Position = UDim2.new(0,0,0,0)
loadingPercentInside.TextXAlignment = Enum.TextXAlignment.Center
loadingPercentInside.TextYAlignment = Enum.TextYAlignment.Center
loadingPercentInside.Parent = loadingBar

-- Spawn Button
local spawnButton = Instance.new("TextButton")
spawnButton.Text = "SPAWN PET"
spawnButton.Font = Enum.Font.SourceSansBold
spawnButton.TextSize = 22
spawnButton.TextColor3 = Color3.new(1,1,1)
spawnButton.BackgroundColor3 = Color3.fromRGB(140,0,255)
spawnButton.Size = UDim2.new(0.8,0,0,45)
spawnButton.Position = UDim2.new(0.1,0,0,305)
spawnButton.Parent = mainFrame

local spawnCorner = Instance.new("UICorner")
spawnCorner.CornerRadius = UDim.new(0,8)
spawnCorner.Parent = spawnButton

-- Visual spawn function
local function spawnVisualPet(petName, weight, age)
    local petsFolder = ReplicatedStorage:FindFirstChild("Pets")
    if not petsFolder then warn("No Pets folder in ReplicatedStorage") return end

    local petModel = petsFolder:FindFirstChild(petName)
    if not petModel then warn("Pet not found: "..petName) return end

    local clone = petModel:Clone()
    clone.Name = petName.." (Visual)"
    clone:SetAttribute("Weight", tonumber(weight) or 1)
    clone:SetAttribute("Age", tonumber(age) or 1)

    -- Fix attachments
    for _, part in pairs(clone:GetDescendants()) do
        if part:IsA("Attachment") and part.Parent and not part.Parent:IsA("BasePart") then
            local handle = clone:FindFirstChild("Handle") or clone:FindFirstChildWhichIsA("BasePart")
            if handle then
                part.Parent = handle
            else
                part:Destroy()
            end
        end
        if part:IsA("BasePart") then
            part.CanCollide = false
            part.Anchored = false
        end
    end

    local tool
    if clone:IsA("Tool") then
        tool = clone
    else
        tool = Instance.new("Tool")
        tool.Name = clone.Name
        tool.RequiresHandle = true
        local handle = Instance.new("Part")
        handle.Size = Vector3.new(2,2,2)
        handle.Transparency = 1
        handle.Name = "Handle"
        handle.CanCollide = false
        handle.Parent = tool
        clone.Parent = tool
    end

    tool.Parent = Backpack

    task.defer(function()
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid") then
            LocalPlayer.Character.Humanoid:EquipTool(tool)
        end
    end)

    -- Animate loading bar
    loadingBarContainer.Visible = true
    loadingBar.Size = UDim2.new(0,0,1,0)
    loadingPercentInside.Text = "0%"

    local duration = 2
    local startTime = tick()
    local connection
    connection = RunService.Heartbeat:Connect(function()
        local elapsed = tick() - startTime
        local percent = math.clamp(elapsed / duration, 0, 1)
        loadingBar.Size = UDim2.new(percent,0,1,0)
        loadingPercentInside.Text = math.floor(percent*100).."%"
        if percent >= 1 then
            loadingBarContainer.Visible = false
            connection:Disconnect()
        end
    end)
end

-- Spawn Button Logic
spawnButton.MouseButton1Click:Connect(function()
    local petName = petBox.Text
    local weight = weightBox.Text
    local age = ageBox.Text

    if petName == "" then
        warn("Please enter a pet name")
        return
    end

    spawnVisualPet(petName, weight, age)
end)
