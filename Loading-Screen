local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")
local StarterGui = game:GetService("StarterGui")
local CoreGui = game:GetService("CoreGui")
local Workspace = game:GetService("Workspace")

local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

-- Disable Roblox Core Notifications GUI
StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.Notifications, false)

-- Remove old UI and blur
if playerGui:FindFirstChild("BlackCoverUI") then
	playerGui.BlackCoverUI:Destroy()
end
for _, effect in ipairs(Lighting:GetChildren()) do
	if effect:IsA("BlurEffect") then
		effect:Destroy()
	end
end

-- Add blur effect
local blur = Instance.new("BlurEffect")
blur.Size = 24
blur.Parent = Lighting

-- Create ScreenGui with very high DisplayOrder
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "BlackCoverUI"
screenGui.IgnoreGuiInset = true
screenGui.ResetOnSpawn = false
screenGui.DisplayOrder = 100000 -- extremely high
screenGui.Parent = playerGui
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- Full screen black frame
local blackFrame = Instance.new("Frame")
blackFrame.Size = UDim2.new(1, 0, 1, 0)
blackFrame.Position = UDim2.new(0, 0, 0, 0)
blackFrame.BackgroundColor3 = Color3.new(0, 0, 0)
blackFrame.BorderSizePixel = 0
blackFrame.ZIndex = 100001 -- extremely high
blackFrame.Parent = screenGui

-- Function to hide other GUI elements except our black screen UI
local function hideOtherGuis()
	-- Hide other PlayerGui children except BlackCoverUI
	for _, gui in pairs(playerGui:GetChildren()) do
		if gui:IsA("ScreenGui") and gui.Name ~= "BlackCoverUI" then
			gui.Enabled = false
		end
	end
	-- Hide CoreGui ScreenGuis except if any you want to keep (here we hide all)
	for _, gui in pairs(CoreGui:GetChildren()) do
		if gui:IsA("ScreenGui") then
			gui.Enabled = false
		end
	end
	-- Hide any BillboardGuis in Workspace (often used for in-world messages)
	for _, obj in pairs(Workspace:GetDescendants()) do
		if obj:IsA("BillboardGui") then
			obj.Enabled = false
		end
	end
end

-- Run every frame
RunService.Heartbeat:Connect(hideOtherGuis)
