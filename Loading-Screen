local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- Clean old UI if exists
if PlayerGui:FindFirstChild("PetSpawnerUI") then
    PlayerGui.PetSpawnerUI:Destroy()
end

-- Pets list
local pets = {
    "Kitsune", "Dragonfly", "Disco bee", "Mimic octopus", 
    "Butterfly", "Raccoon", "T-Rex", "Fennec Fox", "Spinosaurus", "Chicken Zombie"
}

-- Create ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "PetSpawnerUI"
screenGui.Parent = PlayerGui

-- Main frame
local mainFrame = Instance.new("Frame")
mainFrame.Size = UDim2.new(0, 450, 0, 320)
mainFrame.Position = UDim2.new(0.5, -225, 0.5, -160)
mainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
mainFrame.BorderSizePixel = 0
mainFrame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = mainFrame

-- Title
local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, 0, 0, 35)
titleLabel.BackgroundTransparency = 1
titleLabel.Text = "üêæ Xeno's Pet Spawner"
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextSize = 24
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.Parent = mainFrame

-- Pet dropdown label
local petLabel = Instance.new("TextLabel")
petLabel.Text = "Select Pet:"
petLabel.Font = Enum.Font.Gotham
petLabel.TextSize = 18
petLabel.TextColor3 = Color3.fromRGB(220, 220, 220)
petLabel.BackgroundTransparency = 1
petLabel.Position = UDim2.new(0, 20, 0, 60)
petLabel.Size = UDim2.new(0, 120, 0, 30)
petLabel.Parent = mainFrame

-- Pet dropdown button
local petDropdown = Instance.new("TextButton")
petDropdown.Text = "Choose a pet ‚ñº"
petDropdown.Font = Enum.Font.Gotham
petDropdown.TextSize = 18
petDropdown.TextColor3 = Color3.new(1,1,1)
petDropdown.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
petDropdown.Position = UDim2.new(0, 150, 0, 60)
petDropdown.Size = UDim2.new(0, 250, 0, 30)
petDropdown.Parent = mainFrame

local petDropdownCorner = Instance.new("UICorner")
petDropdownCorner.CornerRadius = UDim.new(0, 6)
petDropdownCorner.Parent = petDropdown

-- Dropdown list frame (hidden initially)
local dropdownList = Instance.new("Frame")
dropdownList.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
dropdownList.Position = UDim2.new(0, 150, 0, 90)
dropdownList.Size = UDim2.new(0, 250, 0, 0) -- height zero initially
dropdownList.ClipsDescendants = true
dropdownList.Parent = mainFrame

local dropdownListCorner = Instance.new("UICorner")
dropdownListCorner.CornerRadius = UDim.new(0, 6)
dropdownListCorner.Parent = dropdownList

-- Populate dropdown options
local function createDropdownOption(petName, index)
    local option = Instance.new("TextButton")
    option.Text = petName
    option.Font = Enum.Font.Gotham
    option.TextSize = 16
    option.TextColor3 = Color3.new(1, 1, 1)
    option.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    option.Size = UDim2.new(1, 0, 0, 30)
    option.Position = UDim2.new(0, 0, 0, (index-1)*30)
    option.Parent = dropdownList

    option.MouseEnter:Connect(function()
        option.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
    end)
    option.MouseLeave:Connect(function()
        option.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    end)

    option.MouseButton1Click:Connect(function()
        petDropdown.Text = petName .. " ‚ñº"
        -- close dropdown
        dropdownList:TweenSize(UDim2.new(0, 250, 0, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true)
        dropdownOpen = false
    end)
end

local dropdownOpen = false
petDropdown.MouseButton1Click:Connect(function()
    if dropdownOpen then
        dropdownList:TweenSize(UDim2.new(0, 250, 0, 0), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true)
        dropdownOpen = false
    else
        dropdownList:TweenSize(UDim2.new(0, 250, 0, #pets * 30), Enum.EasingDirection.Out, Enum.EasingStyle.Quad, 0.2, true)
        dropdownOpen = true
    end
end)

for i, petName in ipairs(pets) do
    createDropdownOption(petName, i)
end

-- Age label & box
local ageLabel = Instance.new("TextLabel")
ageLabel.Text = "Age:"
ageLabel.Font = Enum.Font.Gotham
ageLabel.TextSize = 18
ageLabel.TextColor3 = Color3.fromRGB(220, 220, 220)
ageLabel.BackgroundTransparency = 1
ageLabel.Position = UDim2.new(0, 20, 0, 150)
ageLabel.Size = UDim2.new(0, 120, 0, 30)
ageLabel.Parent = mainFrame

local ageBox = Instance.new("TextBox")
ageBox.PlaceholderText = "Enter age (e.g., 1)"
ageBox.Font = Enum.Font.Gotham
ageBox.TextSize = 18
ageBox.TextColor3 = Color3.new(1, 1, 1)
ageBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
ageBox.Position = UDim2.new(0, 150, 0, 150)
ageBox.Size = UDim2.new(0, 250, 0, 30)
ageBox.ClearTextOnFocus = false
ageBox.Parent = mainFrame

local ageBoxCorner = Instance.new("UICorner")
ageBoxCorner.CornerRadius = UDim.new(0, 6)
ageBoxCorner.Parent = ageBox

-- Weight label & box
local weightLabel = Instance.new("TextLabel")
weightLabel.Text = "Weight:"
weightLabel.Font = Enum.Font.Gotham
weightLabel.TextSize = 18
weightLabel.TextColor3 = Color3.fromRGB(220, 220, 220)
weightLabel.BackgroundTransparency = 1
weightLabel.Position = UDim2.new(0, 20, 0, 200)
weightLabel.Size = UDim2.new(0, 120, 0, 30)
weightLabel.Parent = mainFrame

local weightBox = Instance.new("TextBox")
weightBox.PlaceholderText = "Enter weight (e.g., 1)"
weightBox.Font = Enum.Font.Gotham
weightBox.TextSize = 18
weightBox.TextColor3 = Color3.new(1, 1, 1)
weightBox.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
weightBox.Position = UDim2.new(0, 150, 0, 200)
weightBox.Size = UDim2.new(0, 250, 0, 30)
weightBox.ClearTextOnFocus = false
weightBox.Parent = mainFrame

local weightBoxCorner = Instance.new("UICorner")
weightBoxCorner.CornerRadius = UDim.new(0, 6)
weightBoxCorner.Parent = weightBox

-- Spawn Button
local spawnButton = Instance.new("TextButton")
spawnButton.Text = "Spawn Pet"
spawnButton.Font = Enum.Font.GothamBold
spawnButton.TextSize = 22
spawnButton.TextColor3 = Color3.new(1,1,1)
spawnButton.BackgroundColor3 = Color3.fromRGB(140, 0, 255)
spawnButton.Position = UDim2.new(0.5, -100, 0, 260)
spawnButton.Size = UDim2.new(0, 200, 0, 40)
spawnButton.Parent = mainFrame

local spawnCorner = Instance.new("UICorner")
spawnCorner.CornerRadius = UDim.new(0, 8)
spawnCorner.Parent = spawnButton

spawnButton.MouseEnter:Connect(function()
    spawnButton.BackgroundColor3 = Color3.fromRGB(180, 0, 255)
end)
spawnButton.MouseLeave:Connect(function()
    spawnButton.BackgroundColor3 = Color3.fromRGB(140, 0, 255)
end)

-- Spawn pet function
local function spawnVisualPet(petName, age, weight)
    local petsFolder = ReplicatedStorage:FindFirstChild("Pets")
    if not petsFolder then
        warn("Pets folder not found in ReplicatedStorage!")
        return
    end

    local petModel = petsFolder:FindFirstChild(petName)
    if not petModel then
        warn("Pet model not found: "..petName)
        return
    end

    -- Clone the pet tool/model
    local petClone = petModel:Clone()

    -- Set size scale based on weight and age (convert to numbers)
    local scaleWeight = tonumber(weight) or 1
    local scaleAge = tonumber(age) or 1
    local finalScale = math.clamp(scaleWeight * scaleAge, 0.1, 10)

    -- Scale the pet clone's primary parts (usually the Handle or root parts)
    local function scaleModel(model, scale)
        for _, part in pairs(model:GetDescendants()) do
            if part:IsA("BasePart") then
                part.Size = part.Size * scale
                part.CFrame = part.CFrame -- keep position same
                -- Adjust massless property if needed
                if part:IsA("MeshPart") then
                    -- optional: scale mesh size if mesh size differs
                    part.Mesh.Scale = part.Mesh.Scale * scale
                end
            elseif part:IsA("SpecialMesh") then
                part.Scale = part.Scale * scale
            end
        end
    end

    scaleModel(petClone, finalScale)

    -- Parent to backpack so it can be equipped
    petClone.Parent = LocalPlayer.Backpack

    -- Equip the pet tool after short delay
    task.delay(0.1, function()
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid") then
            LocalPlayer.Character.Humanoid:EquipTool(petClone)
        end
    end)
end

-- On Spawn button clicked
spawnButton.MouseButton1Click:Connect(function()
    local selectedPet = petDropdown.Text:gsub(" ‚ñº", "")
    if not table.find(pets, selectedPet) then
        warn("Please select a valid pet!")
        return
    end

    local ageVal = ageBox.Text
    local weightVal = weightBox.Text

    spawnVisualPet(selectedPet, ageVal, weightVal)
end)
