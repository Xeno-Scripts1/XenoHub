local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

-- UI Setup
local screenGui = Instance.new("ScreenGui", PlayerGui)
screenGui.Name = "EggRandomizerUI"
screenGui.ResetOnSpawn = false

local mainFrame = Instance.new("Frame", screenGui)
mainFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
mainFrame.Size = UDim2.new(0, 300, 0, 180)
mainFrame.Position = UDim2.new(0.5, -150, 0.3, 0)
mainFrame.AnchorPoint = Vector2.new(0.5, 0)
mainFrame.Active = true
mainFrame.Draggable = true

local titleBar = Instance.new("TextLabel", mainFrame)
titleBar.Text = "ðŸ¾ Egg Pet Randomizer ðŸ¾"
titleBar.Size = UDim2.new(1, 0, 0, 30)
titleBar.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
titleBar.TextColor3 = Color3.new(1, 1, 1)
titleBar.Font = Enum.Font.GothamBold
titleBar.TextSize = 16
titleBar.TextWrapped = true
titleBar.BackgroundTransparency = 0
titleBar.BorderSizePixel = 0
titleBar.TextXAlignment = Enum.TextXAlignment.Center
titleBar.TextYAlignment = Enum.TextYAlignment.Center

local exitButton = Instance.new("TextButton", mainFrame)
exitButton.Text = "X"
exitButton.Size = UDim2.new(0, 25, 0, 25)
exitButton.Position = UDim2.new(1, -30, 0, 2)
exitButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
exitButton.TextColor3 = Color3.new(1, 1, 1)
exitButton.Font = Enum.Font.GothamBold
exitButton.TextSize = 14
exitButton.MouseButton1Click:Connect(function()
	screenGui:Destroy()
end)

local warning = Instance.new("TextLabel", mainFrame)
warning.Text = "âš ï¸ WARNING: This is NOT a visual dupe!"
warning.Size = UDim2.new(1, -10, 0, 25)
warning.Position = UDim2.new(0, 5, 0, 35)
warning.BackgroundTransparency = 1
warning.TextColor3 = Color3.fromRGB(255, 100, 100)
warning.Font = Enum.Font.Gotham
warning.TextSize = 13
warning.TextWrapped = true
warning.TextXAlignment = Enum.TextXAlignment.Center

local autoButton = Instance.new("TextButton", mainFrame)
autoButton.Size = UDim2.new(1, -10, 0, 30)
autoButton.Position = UDim2.new(0, 5, 0, 65)
autoButton.BackgroundColor3 = Color3.fromRGB(90, 90, 90)
autoButton.TextColor3 = Color3.new(1, 1, 1)
autoButton.Font = Enum.Font.GothamBold
autoButton.TextSize = 14
autoButton.Text = "â™»ï¸ Auto Reroll: OFF"

local manualButton = Instance.new("TextButton", mainFrame)
manualButton.Size = UDim2.new(1, -10, 0, 30)
manualButton.Position = UDim2.new(0, 5, 0, 100)
manualButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
manualButton.TextColor3 = Color3.new(1, 1, 1)
manualButton.Font = Enum.Font.GothamBold
manualButton.TextSize = 14
manualButton.Text = "â™»ï¸ Manual Reroll"

-- Egg Data
local eggChances = {
    ["Common Egg"] = {["Dog"] = 33, ["Bunny"] = 33, ["Golden Lab"] = 33},
    ["Uncommon Egg"] = {["Black Bunny"] = 25, ["Chicken"] = 25, ["Cat"] = 25, ["Deer"] = 25},
    ["Rare Egg"] = {["Orange Tabby"] = 33.33, ["Spotted Deer"] = 25, ["Pig"] = 16.67, ["Rooster"] = 16.67, ["Monkey"] = 8.33},
    ["Legendary Egg"] = {["Cow"] = 42.55, ["Silver Monkey"] = 42.55, ["Sea Otter"] = 10.64, ["Turtle"] = 2.13, ["Polar Bear"] = 2.13},
    ["Dinosaur Egg"] = {["Raptor"] = 33, ["Triceratops"] = 33, ["T-Rex"] = 1, ["Stegosaurus"] = 33, ["Pterodactyl"] = 33, ["Brontosaurus"] = 33}
}

local realESP = {
    ["Common Egg"] = true,
    ["Uncommon Egg"] = true,
    ["Rare Egg"] = true
}

-- Utility
local function weightedRandom(pool)
	local total, pick = 0, nil
	for pet, weight in pairs(pool) do
		if weight > 0 then total += weight end
	end
	local roll = math.random() * total
	local cumulative = 0
	for pet, weight in pairs(pool) do
		if weight > 0 then
			cumulative += weight
			if roll <= cumulative then
				return pet
			end
		end
	end
end

local function createOrUpdateBillboard(egg, text)
	local gui = egg:FindFirstChild("PetESP") or Instance.new("BillboardGui")
	gui.Name = "PetESP"
	gui.AlwaysOnTop = true
	gui.Size = UDim2.new(0, 200, 0, 50)
	gui.StudsOffset = Vector3.new(0, 2.5, 0)
	gui.Adornee = egg:FindFirstChildWhichIsA("BasePart") or egg

	local label = gui:FindFirstChild("TextLabel")
	if not label then
		label = Instance.new("TextLabel", gui)
		label.Size = UDim2.new(1, 0, 1, 0)
		label.BackgroundTransparency = 1
		label.TextColor3 = Color3.new(1, 1, 1)
		label.TextStrokeTransparency = 0
		label.TextScaled = true
		label.Font = Enum.Font.SourceSansBold
	end
	label.Text = text
	gui.Parent = egg
end

-- Scanning
local function findEggs()
	local eggs = {}
	for _, descendant in ipairs(workspace:GetDescendants()) do
		if descendant:IsA("Model") and descendant.Name:match("Egg") and descendant:FindFirstChildWhichIsA("BasePart") then
			local eggName = descendant.Name:match("(.+) Egg")
			if eggName then
				table.insert(eggs, {egg = descendant, name = eggName .. " Egg"})
			end
		end
	end
	return eggs
end

-- Logic
local autoReroll = false
autoButton.MouseButton1Click:Connect(function()
	autoReroll = not autoReroll
	if autoReroll then
		autoButton.Text = "â™»ï¸ Auto Reroll: ON"
		autoButton.BackgroundColor3 = Color3.fromRGB(110, 160, 110)
	else
		autoButton.Text = "â™»ï¸ Auto Reroll: OFF"
		autoButton.BackgroundColor3 = Color3.fromRGB(90, 90, 90)
	end
end)

manualButton.MouseButton1Click:Connect(function()
	for _, info in ipairs(findEggs()) do
		local petName = realESP[info.name] and info.name or (info.name .. " | " .. (weightedRandom(eggChances[info.name]) or "?"))
		createOrUpdateBillboard(info.egg, petName)
	end
end)

-- Auto Loop
task.spawn(function()
	while true do
		if autoReroll then
			for _, info in ipairs(findEggs()) do
				local petName = realESP[info.name] and info.name or (info.name .. " | " .. (weightedRandom(eggChances[info.name]) or "?"))
				createOrUpdateBillboard(info.egg, petName)
			end
		end
		task.wait(1)
	end
end)
